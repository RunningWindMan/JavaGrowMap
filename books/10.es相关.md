#### es相关概念
- 全文搜索
- 倒排索引
- Lucene
- document,mapping,index,field,type,term,term dictionary,posting list
- 分片 副本

#### es的倒排列表
记录单词在文档中的位置，实际的倒排列表中并不只是存了文档ID这么简单，还有一些其它的信息，比如：词频（Term出现的次数）、偏移量（offset）等，方便计算分数和相关度，比如短语搜索就是利用了这个数据结构
查询时使用了B-tree树建立索引，并使用非聚簇索引

#### 缓存机制
会根据比例或大查询等建立缓存，当然也可以不利用缓存查询

#### 查询机制
1、向索引的所有分片 （ shard）都发出查询请求， 各分片返回的时候把元素文档 （ document）和计算后的排名信息一起返回。
2、第一步， 先向所有的 shard 发出请求， 各分片只返回文档 id(注意， 不包括文档 document)和排名相关的信息(也就是文档对应的分值)， 然后按照各分片返回的文档的分数进行重新排序和排名， 取前 size 个文档。
第二步， 根据文档 id 去相关的 shard 取 document。 这种方式返回的 document 数量与用户要求的大小是相等的。
3、DFS